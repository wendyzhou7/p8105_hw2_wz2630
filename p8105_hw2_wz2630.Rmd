---
title: "p8105_hw2_wz2630"
output: github_document
date: "2023-09-28"
---
```{r}
library(tidyverse)
library(readxl)
```

# Problem 1
```{r}
pols_month_df = 
  read_csv("hw2_datasets/pols-month.csv") |> 
  mutate(year = year(mon), month = month(mon), day = day(mon),
         
         case_match(
          month,
          1 ~ "January",
          2 ~ "February",
          3 ~ "March",
          4 ~ "April",
          5 ~ "May",
          6 ~ "June",
          7 ~ "July",
          8 ~ "August",
          9 ~ "September",
          10 ~ "October",
          11 ~ "November",
          12 ~ "December"),
         
         president = recode(prez_gop, "0" = "dem", "1" = "gop", "2" = "gop"))
    
  
```



```{r}
#snp_df = 
  #read_csv("hw2_datasets/snp.csv") |> 
  #mutate(month = month(date), day = day(date), year = year(date),
         #case_match(
         # month,
          #1 ~ "January",
          #2 ~ "February",
          #3 ~ "March",
          #4 ~ "April",
          #5 ~ "May",
          #6 ~ "June",
          #7 ~ "July",
          #8 ~ "August",
         # 9 ~ "September",
         # 10 ~ "October",
        #  11 ~ "November",
        #  12 ~ "December"))
```


# Problem 2

Mr. Trash Wheel
```{r}
mr_trash_wheel = 
  readxl::read_excel("hw2_datasets/202309 Trash Wheel Collection Data.xlsx", 
                     range = "A2:N586") |> 
  janitor::clean_names() |> 
  mutate(homes_powered = (weight_tons*500)/30, 
         trash_wheel = "mr",
         year = as.numeric(year))
```

Professor Trash Wheel
```{r}
prof_trash_wheel = 
  readxl::read_excel("hw2_datasets/202309 Trash Wheel Collection Data.xlsx", 
                     sheet = 2, 
                     range = "A2:M108") |> 
  janitor::clean_names() |> 
  mutate(homes_powered = (weight_tons*500)/30, 
         trash_wheel = "professor")
```

Gwynnda Trash Wheel
```{r}
gwynnda_trash_wheel = 
  readxl::read_excel("hw2_datasets/202309 Trash Wheel Collection Data.xlsx", 
                     sheet = 4, 
                     range = "A2:L157") |> 
  janitor::clean_names() |> 
  mutate(homes_powered = (weight_tons*500)/30, 
         trash_wheel = "gwynnda")
```

Combining 3 trashwheel datasets
```{r}
trash_wheels_df =
  bind_rows(mr_trash_wheel, prof_trash_wheel, gwynnda_trash_wheel)

# total weight of trash collected by Professor Trash Wheel
sum(prof_trash_wheel[, 'weight_tons'])

# total number of cigarette butts collected by Gwynnda in July of 2021
gwynnda_trash_wheel |> 
    group_by(year) |>  
    summarize(num = n(),
              cig_butts_total = sum(cigarette_butts))
```

The combined dataset has 747 observations and 17 variables.
The total weight of trash collected by Professor Trash Wheel is 216.26 tons.
The total number of cigarette butts collected by Gwynnda in July of 2021 is 98,300.



# Problem 3

```{r}
# Load, clean, and filter baseline demographics data
mci_baseline = 
  read_csv("hw2_datasets/data_mci/MCI_baseline.csv",
           skip = 1,
           na = c(".")) |> 
  janitor::clean_names() |> 
  rename("study_id" = "id") |> 
  mutate(
    sex = case_match(
      sex, 
      1 ~ "male",
      0 ~ "female"),
    apoe4 = case_match(
      apoe4, 
      1 ~ "carrier", 
      0 ~ "non-carrier")) |> 
  filter(age_at_onset - current_age > 0) #exclusion criteria: mci at baseline
```


```{r}
# average baseline age
mci_baseline |> 
    summarize(num = n(),
              mean = mean(current_age))
# are we looking for mean age of filtered data? yes


# proportion of women in the study are APOE4 carriers
nrow(filter(mci_baseline, sex == "female" & apoe4 == "carrier")) / nrow(filter(mci_baseline, sex == "female"))
```

**Important steps to import process:**
The important steps to importing the dataset include using the read_csv function, cleaning the variable names into snake case, using the case_match function to turn numeric values of sex and apoe4 into descriptive characters, and removing participants who do not fulfill baseline requirements.

**Relevant features of dataset:**
??? dimensions, variables present, anti_joins, come up with explanations, guesswork

There were originally 483 participants recruited and we then removed those who did not meet the inclusion criteria of no MCI at baseline and filtering for those who do develop MCI, we get 93 remaining participants.
The average baseline age is **65.5** years old. 
**66.67%** of women in the study are APOE4 carriers.


```{r}
# Load amyloid data
mci_amyloid = 
  read_csv("hw2_datasets/data_mci/mci_amyloid.csv",
           skip = 1) |> 
  janitor::clean_names()
```


Check whether some participants appear in only the baseline or amyloid datasets
```{r}
# # shows observations that are only in mci_baseline dataset
anti_join(mci_baseline, mci_amyloid, by="study_id")
```
There are 8 participants that are only included in baseline, but not the amyloid dataset. The study_id of
these participants include: 14, 49, 92, 179, 268, 304, 389, 412.


```{r}
# shows observations that are only in mci_amyloid dataset
anti_join(mci_amyloid, mci_baseline, by="study_id")
```
There are 12 participants that are only included in amyloid, but not the baseline dataset.The study_id of
these participants include: 484, 485, 486, 487, 488, 489, 490, 491, 492, 493, 494, 495.


```{r}
# shows observations that are only in mci_amyloid dataset
mci = 
  inner_join(mci_baseline, mci_amyloid, by = "study_id")
```
After combining the demographic and biomarker datasets so that only participants who appear in both datasets are retained, the resulting dataset (baseline_amyloid) consists of **475** observations with 11 variables.


```{r}
#Export the result as a CSV to your data directory
write_csv(mci, "./mci_df_cleaned.csv")
```








